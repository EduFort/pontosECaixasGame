#include <SFML/Graphics.hpp>
#include <iostream>
#include <vector>
#include <cstdio>

using namespace std;
//Classes
class Linha {
public:
	sf::RectangleShape shape;
	int posicaoX;
	int posicaoY;
	char direction;

	sf::Vector2f tam;

	Linha(char rDirection) {
		shape.setFillColor(sf::Color::Blue);
		direction = rDirection;
		if (direction == 'h') {
			tam = { 107, 12 };
		} else if (direction == 'v') {
			tam = { 12, 107 };
		} else {
			cout << "Error!!!" << endl;
			exit(1);
		}
		shape.setSize(tam);
		posicaoX = 0;
		posicaoY = 0;
	}

	void setaPosicao(int x, int y) {
		posicaoX = x;
		posicaoY = y;
		shape.setPosition(x, y);
	}

};

class Bola {
public:
	sf::CircleShape shape;
	int posicaoX;
	int posicaoY;

	int radius;
	int tam;

	Bola() {
		shape.setFillColor(sf::Color::White);
		tam = 10;
		radius = tam * 2;
		shape.setRadius(tam);
		posicaoX = 0;
		posicaoY = 0;
	}

	void setaPosicao(int x, int y) {
		posicaoX = x;
		posicaoY = y;
		shape.setPosition(x, y);
	}

};

bool isMult(int num, int mult) {
	if (num % mult == 0) {
		return 1;
	} else {
		return 0;
	}
}

//Funções

void setaPosicaoVectorBola(vector<Bola> *bolas) {
	int cont = 0;
	int xOrigem = 194;
	int yOrigem = 104;
	cout << "Abriu a função" << endl;
	int espaco = 107;
	int xBola = xOrigem;
	int yBola = yOrigem;
	for (int i = 0; i < bolas->size(); i++) {
		if (i != 0) {
			if (isMult(i, 6)) {
				xBola = xOrigem;
				yBola = yOrigem;
				cont++;
				yBola += espaco * cont;
			} else {
				xBola += espaco;
			}
			//(*bola).setaPosicao();
			(*bolas)[i].setaPosicao(xBola, yBola);
		} else {
			(*bolas)[i].setaPosicao(xOrigem, yOrigem);
		}
	}
}
void setaPosicaoVectorLinha(vector<Linha> *bolas) {
	int cont = 0;
	int xOrigem = 194 + 5;
	int yOrigem = 104 + 5;
	cout << "Abriu a função" << endl;
	int espacoX = 107 + 30;
	int espacoY = 107;
	int xLinha = xOrigem;
	int yLinha = yOrigem;
	int mult;
	if((*bolas)[0].direction=='r'){
		mult=5;
	}else if((*bolas)[0].direction=='v'){
		mult=5;
	}
	for (int i = 0; i < bolas->size(); i++) {
		if (i != 0) {
			if (isMult(i, mult)) {
				xLinha = xOrigem;
				yLinha = yOrigem;
				cont++;
				yLinha += espacoY * cont;
			} else {
				xLinha += espacoY;
			}
			//(*bola).setaPosicao();
			(*bolas)[i].setaPosicao(xLinha, yLinha);
		} else {
			(*bolas)[i].setaPosicao(xOrigem, yOrigem);
		}
	}
}

int main() {
	setbuf(stdout, NULL);
	// Cria a janela
	sf::RenderWindow window(sf::VideoMode(950, 720), "Bola Branca - SFML");
	std::cout << "rodou" << std::endl;
	//Bola de teste

	vector<Bola> bolasJogo(36);
	vector<Linha> linhasHorizontaisJogo(30, Linha('h'));
	//vector<Linha> linhasVerticaisJogo(30, Linha('v'));

	setaPosicaoVectorBola(&bolasJogo);
	setaPosicaoVectorLinha(&linhasHorizontaisJogo);
	//setaPosicaoVectorLinha(&linhasVerticaisJogo);

	// Loop principal
	sf::Clock fpsClock;
	window.setFramerateLimit(100); //limite de fps

	while (window.isOpen()) { //evenmtos
		sf::Event event;
		while (window.pollEvent(event)) {
			if (event.type == sf::Event::Closed)
				window.close();
		}

		//impressão
		window.clear(sf::Color::Black); // fundo preto
		for (int i = 0; i < linhasHorizontaisJogo.size(); i++) {
			window.draw(linhasHorizontaisJogo[i].shape);
		}
		/*for (int i = 0; i < linhasVerticaisJogo.size(); i++) {
			window.draw(linhasVerticaisJogo[i].shape);
		}*/
		for (int i = 0; i < bolasJogo.size(); i++) {
			window.draw(bolasJogo[i].shape);
		}
		//window.draw(l1.shape);
		window.display();

	}
	return 0;
}
